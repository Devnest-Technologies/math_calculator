version: 1
frontend:
    phases:
        preBuild:
            commands:
                - curl -fsSL https://get.pnpm.io/install.sh | sh -
                - export PNPM_HOME="/root/.local/share/pnpm"
                - export PATH="$PNPM_HOME:$PATH"
                - pnpm install --frozen-lockfile
        build:
            commands:
                - pnpm build
    artifacts:
        baseDirectory: .next # Changed from 'dist' to '.next' for Next.js
        files:
            - "**/*"
    cache:
        paths:
            - node_modules/**/*
            - .pnpm-store/**/*